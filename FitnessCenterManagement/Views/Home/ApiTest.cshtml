@{
    ViewData["Title"] = "REST API Test";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="fw-bold mb-0" style="color: #675889;">REST API Test Sayfası</h1>
    <a asp-controller="Home" asp-action="Index" class="btn text-white shadow-sm" style="background-color: #006666; border-radius: 10px;">
        <i class="bi bi-house-door"></i> Ana Sayfaya Dön
    </a>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4 border-0 shadow-sm" style="border-radius: 20px;">
            <div class="card-header text-white border-0" style="background-color: #675889; border-radius: 20px 20px 0 0;">
                <h5 class="mb-0 p-1"><i class="bi bi-person-badge-fill me-2"></i>Antrenör API'leri</h5>
            </div>
            <div class="card-body p-4">
                <h6 class="text-muted small text-uppercase fw-bold">1. Pazartesi Çalışan Antrenörler</h6>
                <button class="btn w-100 mb-3 api-btn" onclick="apiTest('/api/trainers/monday')"
                        style="border: 2px solid #675889; color: #675889;">
                    Test Et →
                </button>

                <h6 class="text-muted small text-uppercase fw-bold">2. Tüm Antrenörler</h6>
                <button class="btn w-100 mb-3 api-btn" onclick="apiTest('/api/trainers')"
                        style="border: 2px solid #a29bfe; color: #a29bfe;">
                    Verileri Getir
                </button>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card mb-4 border-0 shadow-sm" style="border-radius: 20px;">
            <div class="card-header text-white border-0" style="background-color: #006666; border-radius: 20px 20px 0 0;">
                <h5 class="mb-0 p-1"><i class="bi bi-building-fill me-2"></i>Spor Salonu API'leri</h5>
            </div>
            <div class="card-body p-4">
                <h6 class="text-muted small text-uppercase fw-bold">1. 23:00'da Açık Salonlar</h6>
                <button class="btn w-100 mb-3 api-btn" onclick="apiTest('/api/fitnesscenters/open-at-23')"
                        style="border: 2px solid #006666; color: #006666;">
                    Test Et →
                </button>

                <h6 class="text-muted small text-uppercase fw-bold">2. Belirli Saatte Açık Salonlar</h6>
                <div class="input-group mb-3">
                    <input type="number" class="form-control border-end-0" id="hourInput" placeholder="Saat" min="0" max="23" value="20"
                           style="border-radius: 10px 0 0 10px; border-color: #00a3a3;">
                    <button class="btn btn-dark" onclick="apiTest('', true)"
                            style="background-color: #00a3a3; border-color: #00a3a3; border-radius: 0 10px 10px 0;">
                        Sorgula
                    </button>
                </div>

                <h6 class="text-muted small text-uppercase fw-bold">3. Tüm Salonlar</h6>
                <button class="btn w-100 mb-3 api-btn" onclick="apiTest('/api/fitnesscenters')"
                        style="border: 2px solid #48c9b0; color: #48c9b0;">
                    Listeyi Çek
                </button>
            </div>
        </div>
    </div>
</div>

<div class="card border-0 shadow-lg" style="border-radius: 25px;">
    <div class="card-header bg-dark text-white border-0 p-3" style="border-radius: 25px 25px 0 0;">
        <h5 class="mb-0 d-inline-block me-2"><i class="bi bi-terminal me-2"></i>API Yanıtı</h5>
    </div>
    <div class="card-body p-0">
        <div id="loading" class="text-center py-5" style="display: none;">
            <div class="spinner-border" style="color: #675889;" role="status"></div>
            <p class="mt-2 fw-bold text-muted">Veri sunucudan çekiliyor...</p>
        </div>
        <pre id="result" class="m-0 p-4" style="background-color: #f8f9fa; max-height: 400px; overflow-y: auto; font-family: 'Consolas', monospace; font-size: 0.9rem; color: #2d3436; border-radius: 0 0 25px 25px;">
 Test butonuna basıldığında sonuçlar burada listelenecek.
        </pre>
    </div>
</div>

@section Styles {
    <style>
        .api-btn {
            background-color: transparent;
            font-weight: 600;
            border-radius: 12px;
            transition: all 0.3s ease;
            text-align: left;
            padding-left: 20px;
        }

            .api-btn:hover {
                transform: translateX(5px);
                background-color: #f1f2f6;
                box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            }

            .api-btn[onclick*="trainers/monday"]:hover {
                background-color: #675889;
                color: white !important;
            }

            .api-btn[onclick*="api/trainers')"]:hover {
                background-color: #a29bfe;
                color: white !important;
            }

            .api-btn[onclick*="open-at-23"]:hover {
                background-color: #006666;
                color: white !important;
            }

            .api-btn[onclick*="fitnesscenters')"]:hover {
                background-color: #48c9b0;
                color: white !important;
            }

        input:focus {
            box-shadow: none !important;
            border-color: #00a3a3 !important;
        }
    </style>
}

@section Scripts {
    <script>
        async function apiTest(url, isHourInput = false) {
            const resultArea = document.getElementById('result');
            const loading = document.getElementById('loading');
            let finalUrl = isHourInput ? `/api/fitnesscenters/open-at/${document.getElementById('hourInput').value}` : url;

            loading.style.display = 'block';
            resultArea.textContent = '';

            try {
                const response = await fetch(finalUrl);
                const data = await response.json();
                resultArea.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                resultArea.textContent = 'HATA: ' + error.message;
            } finally {
                loading.style.display = 'none';
            }
        }
    </script>
}